
match /users/{userId} {
  // Qualquer usuário autenticado pode ler perfis (para ver nomes, fotos, etc).
  // Um usuário só pode escrever em seu próprio perfil.
  allow read: if isSignedIn();
  allow write: if isOwner(userId);

  // Regras para subcoleções de 'users'
  match /plans/{planId} {
    allow read, write: if isOwner(userId);
  }
  
  match /armors/{armorId} {
    allow read, write: if isOwner(userId);
  }

  match /messages/{messageId} {
    allow read, write: if isOwner(userId);
  }

  match /battlePlans/{userPlanId} {
    allow read, write: if isOwner(userId);
  }
}

match /userPushTokens/{tokenId} {
    // Um usuário só pode criar ou gerenciar seu próprio token.
    allow read, write: if isSignedIn() && request.resource.data.userId == request.auth.uid;
}
