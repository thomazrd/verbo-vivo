// Funções relacionadas à autenticação

function isSignedIn() {
  return request.auth != null;
}

// Verifica se o usuário autenticado é o dono do recurso
function isUser(userId) {
  return isSignedIn() && request.auth.uid == userId;
}

// Verifica se o usuário tem a claim de ADMIN em seu token
function isAdmin() {
  return isSignedIn() && request.auth.token.role == 'ADMIN';
}

// Verifica se o usuário é um membro ou admin da congregação
function isCongregationMember(congregationId) {
    return isSignedIn() && get(/databases/$(database)/documents/congregations/$(congregationId)/members/$(request.auth.uid)).data.status in ['MEMBER', 'ADMIN'];
}

// Verifica se o usuário é um admin da congregação
function isCongregationAdmin(congregationId) {
    return isSignedIn() && get(/databases/$(database)/documents/congregations/$(congregationId)/members/$(request.auth.uid)).data.status == 'ADMIN';
}